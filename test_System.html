<html><body>
<script type="text/javascript" src="numeric-1.2.6.js"></script>
<script type="text/javascript" src="math.js"></script>
<script type="text/javascript" src="system.js"></script>
<script type="text/javascript" src="flot/jquery.js"></script>
<script type="text/javascript" src="flot/jquery.flot.js"></script>
<script type="text/javascript">

// Demonstration script starts here
var S = Object.create(System);  // Lotka-Volterra predator/prey 
// load math.js
S.addSpecies('X0', 1, 'hare');
S.addSpecies('X1', 1, 'fox');
S.addSpecies('X2', 1, 'eagle');
S.addParameter('alpha', 1., 'prey specific growth rate')
S.addParameter('beta', .01, 'predation rate constant')
S.addParameter('gamma', 1., 'trophic efficiency')
S.addParameter('delta', 1., 'predator death rate constant')
//S.add_function('f', 'alpha * P0', 'prey growth rate')
//S.add_function('g', 'beta * P0 * P1', 'functional response')
//S.add_function('h', 'gamma * g', 'numerical_response')
//S.add_function('i', 'delta * P1', 'predator death')
//S.species['P0'].rate_law.set('f - g')
//S.species['P1'].rate_law.set('h - i')
//S.addParameter('DELTA', .1, 'hormonal delay');


//S.addRule('g', 'g(S,K)=S/(S+K)', 'Hyperbolic');
//S.addRule('h', 'h(a,b,k) = k - a - b', 'self-inhibition');
//S.addRule('alpha', 'alpha(g)=1/g', 'agonist function');
//S.addRule('beta', 'beta(g)=g', 'antagonist function');
//S.addRule('dX0', 'dX0(G, A, B, input, a, b, eta) = input + a*A - b*B - eta * G');
//S.addRule('dX1', 'dX1(G, A, B, k, delta) = A * ( alpha(G)*h(A,B,k) - delta )');
//S.addRule('dX2', 'dX2(G, A, B, k, delta) = B * ( beta(G)*h(A,B,k) - delta )');

//S.species['X0'].rate_law.set('A * ( 1 / G * h - delta )')
//S.species['X1'].rate_law.set('B * ( G * h - delta )')
//S.species['X2'].rate_law.set('input + alpha * A - beta * B - eta * G')

//console.log(S.parser.eval('X1'));
//console.log(S.parser.eval('X2'));
//console.log(S.parser.eval('dX0(X0,X1,X2,INPUT,A,B,ETA)'));
//console.log(S.parser.eval('dX1(X0,X1,X2,K,DELTA)'));
//console.log(S.parser.eval('dX2(X0,X1,X2,K,DELTA)'));

//S.defineInteraction('predator-prey', ['A', 'B']);
//S.interactions['predator-prey'].rules['A'].set('-k*A*B', 'functional response');
//S.interactions['predator-prey'].rules['B'].set('-k*e*A*B', 'functional response');

//S.interactions['predator-prey'].addRule('A', '-k*A*B', 'functional response');
//S.interactions['predator-prey'].addRule('B', 'k*e*A*B', 'numerical response');
//S.defineInteraction('exponential growth');
//S.interactions['exponential growth'].addRule('A', 'k*A', 'exponential growth');
//S.defineInteraction('first-order decay');
//S.interactions['first-order decay'].addRule('A', '-k*A', 'first order decay');

//S.addInteraction('predator-prey', ['X0','X1'], ['beta', 'gamma']);
//S.addInteraction('predator-prey', ['X1','X2'], ['beta', 'gamma']);

//S.interactions['predator-prey']
//S.addInteraction('exponential-growth', ['X0'], ['alpha']);
//S.addInteraction('exponential-growth', ['X0'], ['alpha']);
S.defineInteraction('first-order test', ['A']);
S.interactions['first-order test'].rules['A'].set('1-a*A');
S.addInteraction('first-order test', ['X0'], ['beta']);
sol = S.simulate();
t = sol.t;
y = numeric.transpose(sol.y);
p = [numeric.transpose([t, y[0]])];
$(function() {

	$.plot("#placeholder", p);

});
//S.addInteraction('first-order decay', ['X1'], ['delta']);
//var node = math.parse('g()');
//node.traverse(function (node, path, parent) {
//   if (node.type == 'SymbolNode') {
//      console.log(node.name);
//   }
//});

</script>
<div id="placeholder" style="width:600px;height:300px"></div>